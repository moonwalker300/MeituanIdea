52
0.627341383832673 0.4700101097054401
1.1589062479079542 0.9252615432353195
Inverse Propensity Score Weight STD and Mean 17.586344526827567 0.7985576827703699
0.23356607578937746 56.50051302599464
1.281264686475644 2.0181202111399514
Optimal Policy Value: 1.3919306300848497
Epoch 99
Loss 0.480529
Epoch 199
Loss 0.363121
Epoch 299
Loss 0.342211
Epoch 399
Loss 0.331723
Epoch 499
Loss 0.321921
290.24207
53.070576
Epoch 1000, Loss 0.039048
Epoch 2000, Loss 0.038612
Epoch 3000, Loss 0.036494
Epoch 4000, Loss 0.034863
Epoch 5000, Loss 0.034138
Epoch 6000, Loss 0.033137
Epoch 7000, Loss 0.032548
Epoch 8000, Loss 0.031979
Epoch 9000, Loss 0.031877
Epoch 10000, Loss 0.031770
Iter 0 DM Search Optimized Policy Value: 1.2230296199159407
290.24207
53.070576
Epoch 1000, Loss 0.033691
Epoch 2000, Loss 0.032405
Epoch 3000, Loss 0.032803
Epoch 4000, Loss 0.031170
Epoch 5000, Loss 0.030794
Epoch 6000, Loss 0.030017
Epoch 7000, Loss 0.029816
Epoch 8000, Loss 0.029587
Epoch 9000, Loss 0.029428
Epoch 10000, Loss 0.029388
Iter 1 DM Search Optimized Policy Value: 1.2399259502095112
290.24207
53.070576
Epoch 1000, Loss 0.031448
Epoch 2000, Loss 0.030571
Epoch 3000, Loss 0.029849
Epoch 4000, Loss 0.029334
Epoch 5000, Loss 0.029156
Epoch 6000, Loss 0.028696
Epoch 7000, Loss 0.028520
Epoch 8000, Loss 0.028327
Epoch 9000, Loss 0.028191
Epoch 10000, Loss 0.028161
Iter 2 DM Search Optimized Policy Value: 1.2177001768245295
290.24207
53.070576
Epoch 1000, Loss 0.030238
Epoch 2000, Loss 0.029738
Epoch 3000, Loss 0.028425
Epoch 4000, Loss 0.029152
Epoch 5000, Loss 0.028256
Epoch 6000, Loss 0.027790
Epoch 7000, Loss 0.027754
Epoch 8000, Loss 0.027598
Epoch 9000, Loss 0.027416
Epoch 10000, Loss 0.027370
Iter 3 DM Search Optimized Policy Value: 1.2299209224377818
290.24207
53.070576
Epoch 1000, Loss 0.028564
Epoch 2000, Loss 0.029074
Epoch 3000, Loss 0.029540
Epoch 4000, Loss 0.028336
Epoch 5000, Loss 0.027973
Epoch 6000, Loss 0.027480
Epoch 7000, Loss 0.027269
Epoch 8000, Loss 0.027128
Epoch 9000, Loss 0.027005
Epoch 10000, Loss 0.026978
Iter 4 DM Search Optimized Policy Value: 1.2689820505522247
290.24207
53.070576
Epoch 1000, Loss 0.028757
Epoch 2000, Loss 0.029886
Epoch 3000, Loss 0.028077
Epoch 4000, Loss 0.027332
Epoch 5000, Loss 0.027137
Epoch 6000, Loss 0.026836
Epoch 7000, Loss 0.026608
Epoch 8000, Loss 0.026516
Epoch 9000, Loss 0.026461
Epoch 10000, Loss 0.026423
Iter 5 DM Search Optimized Policy Value: 1.2778257066099223
0.19038480296768678
0.06174455380829625
0.7174889637559693
DM Search Optimized Policy Value: 1.2778257066099223
[1238  235  748 1454  848 1245 1063 1403 1089 1662 1851  561  994 1369
 1481 1361  496  529 1687 1154]
[[ 5.76314261  3.8746278 ]
 [ 4.46217981  2.53810414]
 [ 3.60813273  1.59515142]
 [ 4.27213694  2.25287287]
 [ 3.53815519  1.51770271]
 [ 3.66177321  1.61201359]
 [ 4.21721666  2.14708782]
 [ 5.19166553  3.07882255]
 [ 3.30280875  1.17155481]
 [ 4.6779889   2.4752052 ]
 [ 3.76274899  1.55959326]
 [ 4.43576062  2.20520033]
 [ 4.15772082  1.90893432]
 [ 3.16464423  0.86124213]
 [10.35137646  7.89049059]
 [ 3.95231313  0.81858993]
 [ 5.10129408  1.80284421]
 [ 4.72223847  1.18670466]
 [ 4.83077353  1.19910612]
 [ 7.79058497  4.08986887]]
Epoch 99
Loss 0.438380
Epoch 199
Loss 0.373880
Epoch 299
Loss 0.358063
Epoch 399
Loss 0.320789
Epoch 499
Loss 0.329419
407.92822
52.377888
Epoch 1000, Loss 0.038786
Epoch 2000, Loss 0.037138
Epoch 3000, Loss 0.036363
Epoch 4000, Loss 0.034531
Epoch 5000, Loss 0.033724
Epoch 6000, Loss 0.033318
Epoch 7000, Loss 0.032916
Epoch 8000, Loss 0.032814
Epoch 9000, Loss 0.032573
Epoch 10000, Loss 0.032523
Iter 0 DM Search Optimized Policy Value: 1.2640513983859296
407.92822
52.377888
Epoch 1000, Loss 0.034100
Epoch 2000, Loss 0.032739
Epoch 3000, Loss 0.033019
Epoch 4000, Loss 0.032348
Epoch 5000, Loss 0.031986
Epoch 6000, Loss 0.031706
Epoch 7000, Loss 0.031348
Epoch 8000, Loss 0.031139
Epoch 9000, Loss 0.031065
Epoch 10000, Loss 0.031033
Iter 1 DM Search Optimized Policy Value: 1.2921630228434342
407.92822
52.377888
Epoch 1000, Loss 0.031941
Epoch 2000, Loss 0.032137
Epoch 3000, Loss 0.031570
Epoch 4000, Loss 0.030831
Epoch 5000, Loss 0.030306
Epoch 6000, Loss 0.030259
Epoch 7000, Loss 0.030091
Epoch 8000, Loss 0.029896
Epoch 9000, Loss 0.029836
Epoch 10000, Loss 0.029778
Iter 2 DM Search Optimized Policy Value: 1.2951950054219374
407.92822
52.377888
Epoch 1000, Loss 0.031595
Epoch 2000, Loss 0.031059
Epoch 3000, Loss 0.030433
Epoch 4000, Loss 0.029814
Epoch 5000, Loss 0.029646
Epoch 6000, Loss 0.029441
Epoch 7000, Loss 0.029074
Epoch 8000, Loss 0.028954
Epoch 9000, Loss 0.028855
Epoch 10000, Loss 0.028863
Iter 3 DM Search Optimized Policy Value: 1.284461365461807
407.92822
52.377888
Epoch 1000, Loss 0.029916
Epoch 2000, Loss 0.029959
Epoch 3000, Loss 0.030069
Epoch 4000, Loss 0.028929
Epoch 5000, Loss 0.028660
Epoch 6000, Loss 0.028428
Epoch 7000, Loss 0.028009
Epoch 8000, Loss 0.027962
Epoch 9000, Loss 0.027876
Epoch 10000, Loss 0.027851
Iter 4 DM Search Optimized Policy Value: 1.2969950969325579
407.92822
52.377888
Epoch 1000, Loss 0.029950
Epoch 2000, Loss 0.028602
Epoch 3000, Loss 0.028282
Epoch 4000, Loss 0.028002
Epoch 5000, Loss 0.028193
Epoch 6000, Loss 0.027820
Epoch 7000, Loss 0.027427
Epoch 8000, Loss 0.027261
Epoch 9000, Loss 0.027181
Epoch 10000, Loss 0.027163
Iter 5 DM Search Optimized Policy Value: 1.3108494265544823
0.18818125375587988
0.0707185544482637
1.1628302592776507
DM Search Optimized Policy Value: 1.3108494265544823
[1221 1895  639  171 1226 1831 1140 1825 1063  217 1149 1238  235 1454
 1403 1662  561  994 1481 1154]
[[ 4.77027941  3.66214605]
 [ 5.0442856   3.87516686]
 [ 4.71008204  3.42248135]
 [ 4.03257697  2.73630362]
 [ 1.77469701  0.45037158]
 [ 7.16586962  5.840935  ]
 [ 3.29279654  1.94183077]
 [ 4.13279991  2.76371806]
 [ 4.21721666  2.54186652]
 [ 4.89804461  3.05084919]
 [ 7.41912594  5.5536861 ]
 [ 5.76314261  3.87917448]
 [ 4.46217981  2.53810414]
 [ 4.27213694  2.27085506]
 [ 5.19166553  3.10035721]
 [ 4.6779889   2.4752052 ]
 [ 4.43576062  2.21638238]
 [ 4.15772082  1.90547311]
 [10.35137646  7.89049059]
 [ 7.79058497  4.09641528]]
Epoch 99
Loss 0.463247
Epoch 199
Loss 0.339315
Epoch 299
Loss 0.324426
Epoch 399
Loss 0.317762
Epoch 499
Loss 0.310698
277.7056
66.42291
Epoch 1000, Loss 0.037821
Epoch 2000, Loss 0.036263
Epoch 3000, Loss 0.035272
Epoch 4000, Loss 0.034195
Epoch 5000, Loss 0.033947
Epoch 6000, Loss 0.033370
Epoch 7000, Loss 0.032886
Epoch 8000, Loss 0.032727
Epoch 9000, Loss 0.032579
Epoch 10000, Loss 0.032547
Iter 0 DM Search Optimized Policy Value: 1.2924775673533655
277.7056
66.42291
Epoch 1000, Loss 0.033290
Epoch 2000, Loss 0.033001
Epoch 3000, Loss 0.031719
Epoch 4000, Loss 0.031941
Epoch 5000, Loss 0.031302
Epoch 6000, Loss 0.030714
Epoch 7000, Loss 0.030566
Epoch 8000, Loss 0.030392
Epoch 9000, Loss 0.030245
Epoch 10000, Loss 0.030215
Iter 1 DM Search Optimized Policy Value: 1.3174991534077114
277.7056
66.42291
Epoch 1000, Loss 0.031596
Epoch 2000, Loss 0.031700
Epoch 3000, Loss 0.030648
Epoch 4000, Loss 0.029868
Epoch 5000, Loss 0.029305
Epoch 6000, Loss 0.029113
Epoch 7000, Loss 0.028777
Epoch 8000, Loss 0.028656
Epoch 9000, Loss 0.028559
Epoch 10000, Loss 0.028503
Iter 2 DM Search Optimized Policy Value: 1.3011531637531901
277.7056
66.42291
Epoch 1000, Loss 0.029957
Epoch 2000, Loss 0.029014
Epoch 3000, Loss 0.029244
Epoch 4000, Loss 0.028819
Epoch 5000, Loss 0.028457
Epoch 6000, Loss 0.027659
Epoch 7000, Loss 0.027456
Epoch 8000, Loss 0.027319
Epoch 9000, Loss 0.027150
Epoch 10000, Loss 0.027113
Iter 3 DM Search Optimized Policy Value: 1.2954991313676312
277.7056
66.42291
Epoch 1000, Loss 0.028693
Epoch 2000, Loss 0.028622
Epoch 3000, Loss 0.027757
Epoch 4000, Loss 0.027219
Epoch 5000, Loss 0.027128
Epoch 6000, Loss 0.026690
Epoch 7000, Loss 0.026477
Epoch 8000, Loss 0.026310
Epoch 9000, Loss 0.026133
Epoch 10000, Loss 0.026081
Iter 4 DM Search Optimized Policy Value: 1.2730670180618027
277.7056
66.42291
Epoch 1000, Loss 0.027401
Epoch 2000, Loss 0.027594
Epoch 3000, Loss 0.026978
Epoch 4000, Loss 0.026603
Epoch 5000, Loss 0.026277
Epoch 6000, Loss 0.025994
Epoch 7000, Loss 0.025649
Epoch 8000, Loss 0.025503
Epoch 9000, Loss 0.025391
Epoch 10000, Loss 0.025340
Iter 5 DM Search Optimized Policy Value: 1.2469699185246867
0.18936154413393458
0.0725369832477233
1.558757130284385
DM Search Optimized Policy Value: 1.2469699185246867
[1205 1481  109 1671  498   66 1405    8   48 1361  155  451  496  529
 1687 1154  477 1365 1990 1230]
[[ 2.91019382  0.63666049]
 [10.35137646  7.89049059]
 [ 3.29096154  0.65873402]
 [ 3.31800353  0.6761996 ]
 [ 3.62688584  0.90258076]
 [ 3.44849854  0.67793339]
 [ 3.53159121  0.69586825]
 [ 4.22614652  1.14905804]
 [ 3.60764437  0.50428907]
 [ 3.95231313  0.81858993]
 [ 3.84539644  0.63823456]
 [ 3.97034191  0.68379991]
 [ 5.10129408  1.80284421]
 [ 4.72223847  1.18670466]
 [ 4.83077353  1.19910612]
 [ 7.79058497  4.08986887]
 [ 4.51652233  0.62679616]
 [ 4.87852553  0.89998786]
 [ 4.62584294  0.6182708 ]
 [ 5.36041249  0.96110969]]
Epoch 99
Loss 0.476184
Epoch 199
Loss 0.405412
Epoch 299
Loss 0.345343
Epoch 399
Loss 0.324190
Epoch 499
Loss 0.331265
307.13776
58.54989
Epoch 1000, Loss 0.039761
Epoch 2000, Loss 0.036887
Epoch 3000, Loss 0.035390
Epoch 4000, Loss 0.033783
Epoch 5000, Loss 0.033123
Epoch 6000, Loss 0.032849
Epoch 7000, Loss 0.032346
Epoch 8000, Loss 0.032096
Epoch 9000, Loss 0.032011
Epoch 10000, Loss 0.031973
Iter 0 DM Search Optimized Policy Value: 1.3293966335909986
307.13776
58.54989
Epoch 1000, Loss 0.033058
Epoch 2000, Loss 0.032051
Epoch 3000, Loss 0.031640
Epoch 4000, Loss 0.031828
Epoch 5000, Loss 0.031390
Epoch 6000, Loss 0.031222
Epoch 7000, Loss 0.031215
Epoch 8000, Loss 0.030899
Epoch 9000, Loss 0.030780
Epoch 10000, Loss 0.030706
Iter 1 DM Search Optimized Policy Value: 1.3456823056007812
307.13776
58.54989
Epoch 1000, Loss 0.031865
Epoch 2000, Loss 0.031386
Epoch 3000, Loss 0.031023
Epoch 4000, Loss 0.030557
Epoch 5000, Loss 0.030231
Epoch 6000, Loss 0.029818
Epoch 7000, Loss 0.029495
Epoch 8000, Loss 0.029265
Epoch 9000, Loss 0.029225
Epoch 10000, Loss 0.029158
Iter 2 DM Search Optimized Policy Value: 1.3381877500573218
307.13776
58.54989
Epoch 1000, Loss 0.030584
Epoch 2000, Loss 0.030964
Epoch 3000, Loss 0.029608
Epoch 4000, Loss 0.029099
Epoch 5000, Loss 0.029003
Epoch 6000, Loss 0.028903
Epoch 7000, Loss 0.028473
Epoch 8000, Loss 0.028265
Epoch 9000, Loss 0.028118
Epoch 10000, Loss 0.028053
Iter 3 DM Search Optimized Policy Value: 1.3291616986809627
307.13776
58.54989
Epoch 1000, Loss 0.029208
Epoch 2000, Loss 0.029457
Epoch 3000, Loss 0.029144
Epoch 4000, Loss 0.029061
Epoch 5000, Loss 0.028836
Epoch 6000, Loss 0.027857
Epoch 7000, Loss 0.027664
Epoch 8000, Loss 0.027459
Epoch 9000, Loss 0.027331
Epoch 10000, Loss 0.027300
Iter 4 DM Search Optimized Policy Value: 1.3298447145289243
307.13776
58.54989
Epoch 1000, Loss 0.029322
Epoch 2000, Loss 0.030087
Epoch 3000, Loss 0.028206
Epoch 4000, Loss 0.028381
Epoch 5000, Loss 0.027771
Epoch 6000, Loss 0.027194
Epoch 7000, Loss 0.026922
Epoch 8000, Loss 0.026687
Epoch 9000, Loss 0.026540
Epoch 10000, Loss 0.026467
Iter 5 DM Search Optimized Policy Value: 1.3328806274848173
0.1881858812583765
0.06924124221160419
1.59427928190114
DM Search Optimized Policy Value: 1.3328806274848173
[1221 1895  639  171 1831 1149  421  472 1825 1582  217 1238  235 1454
 1063 1403 1662  561 1481 1154]
[[ 4.77027941  3.65544393]
 [ 5.0442856   3.87516686]
 [ 4.71008204  3.41192824]
 [ 4.03257697  2.71079725]
 [ 7.16586962  5.840935  ]
 [ 7.41912594  6.04322197]
 [ 3.95241641  2.51264247]
 [ 1.44278328  0.        ]
 [ 4.13279991  2.41318526]
 [ 3.89544111  2.14958359]
 [ 4.89804461  3.05084919]
 [ 5.76314261  3.8746278 ]
 [ 4.46217981  2.54182995]
 [ 4.27213694  2.25287287]
 [ 4.21721666  2.14708782]
 [ 5.19166553  3.07882255]
 [ 4.6779889   2.4752052 ]
 [ 4.43576062  2.20892361]
 [10.35137646  7.89049059]
 [ 7.79058497  4.08986887]]
Epoch 99
Loss 0.458725
Epoch 199
Loss 0.356332
Epoch 299
Loss 0.335302
Epoch 399
Loss 0.336750
Epoch 499
Loss 0.320255
212.32762
87.06063
Epoch 1000, Loss 0.040786
Epoch 2000, Loss 0.036431
Epoch 3000, Loss 0.033833
Epoch 4000, Loss 0.032968
Epoch 5000, Loss 0.033089
Epoch 6000, Loss 0.032051
Epoch 7000, Loss 0.031429
Epoch 8000, Loss 0.031340
Epoch 9000, Loss 0.031077
Epoch 10000, Loss 0.031020
Iter 0 DM Search Optimized Policy Value: 1.273807132613514
212.32756
87.06062
Epoch 1000, Loss 0.031987
Epoch 2000, Loss 0.031496
Epoch 3000, Loss 0.030635
Epoch 4000, Loss 0.030275
Epoch 5000, Loss 0.029850
Epoch 6000, Loss 0.029402
Epoch 7000, Loss 0.028934
Epoch 8000, Loss 0.028770
Epoch 9000, Loss 0.028669
Epoch 10000, Loss 0.028599
Iter 1 DM Search Optimized Policy Value: 1.222370564207046
212.32762
87.06063
Epoch 1000, Loss 0.030505
Epoch 2000, Loss 0.029312
Epoch 3000, Loss 0.028657
Epoch 4000, Loss 0.028208
Epoch 5000, Loss 0.027759
Epoch 6000, Loss 0.027594
Epoch 7000, Loss 0.027164
Epoch 8000, Loss 0.026897
Epoch 9000, Loss 0.026749
Epoch 10000, Loss 0.026694
Iter 2 DM Search Optimized Policy Value: 1.1830383055381357
212.32756
87.06062
Epoch 1000, Loss 0.027738
Epoch 2000, Loss 0.027604
Epoch 3000, Loss 0.026960
Epoch 4000, Loss 0.027110
Epoch 5000, Loss 0.026652
Epoch 6000, Loss 0.026497
Epoch 7000, Loss 0.025709
Epoch 8000, Loss 0.025624
Epoch 9000, Loss 0.025519
Epoch 10000, Loss 0.025443
Iter 3 DM Search Optimized Policy Value: 1.1810796323548776
212.32762
87.06063
Epoch 1000, Loss 0.026766
Epoch 2000, Loss 0.028351
Epoch 3000, Loss 0.026599
Epoch 4000, Loss 0.026116
Epoch 5000, Loss 0.025500
Epoch 6000, Loss 0.025179
Epoch 7000, Loss 0.024942
Epoch 8000, Loss 0.024783
Epoch 9000, Loss 0.024642
Epoch 10000, Loss 0.024616
Iter 4 DM Search Optimized Policy Value: 1.169830935478267
212.32756
87.06062
Epoch 1000, Loss 0.025989
Epoch 2000, Loss 0.026676
Epoch 3000, Loss 0.025393
Epoch 4000, Loss 0.025124
Epoch 5000, Loss 0.024692
Epoch 6000, Loss 0.024486
Epoch 7000, Loss 0.024283
Epoch 8000, Loss 0.024093
Epoch 9000, Loss 0.023996
Epoch 10000, Loss 0.023926
Iter 5 DM Search Optimized Policy Value: 1.12895864127149
0.18821255844739282
0.07165355667184954
1.1975975949237727
DM Search Optimized Policy Value: 1.12895864127149
[1793 1405  537    1    8   48 1361  155  496  451  529 1687 1154 1575
  477 1365 1990 1230  482 1149]
[[3.0905728  0.27178993]
 [3.53159121 0.70856754]
 [2.96833204 0.09667587]
 [3.10275532 0.09827867]
 [4.22614652 1.16394382]
 [3.60764437 0.5422147 ]
 [3.95231313 0.87066622]
 [3.84539644 0.65709649]
 [5.10129408 1.81879936]
 [3.97034191 0.68598585]
 [4.72223847 1.18989525]
 [4.83077353 1.20235038]
 [7.79058497 4.08986887]
 [3.9768715  0.25953566]
 [4.51652233 0.62679616]
 [4.87852553 0.90558619]
 [4.62584294 0.62483393]
 [5.36041249 0.96110969]
 [4.97517013 0.13971065]
 [7.41912594 0.39641924]]
Train: 0.06917897807754739
Test: 1.2461906460285834
[1.2778257066099223, 1.3108494265544823, 1.2469699185246867, 1.3328806274848173, 1.12895864127149]
Value: 1.2594968640890798
