6
0.42688636016064063 0.2696500962357738
0.9364709607181462 0.46554895017642445
Inverse Propensity Score Weight STD and Mean 3.164686330081955 0.4348046464955639
186.35530162346436
0.25394546121565753 5.259187961163398
0.7124350944785297 0.3503426245585969
Optimal Policy Value: 1.128498478101058
[0.40067817] [0.24298102] [0.21742876] [0.73113472]
4000.0
1.0
Epoch 100, Loss 0.036611
Epoch 200, Loss 0.031644
Epoch 300, Loss 0.028301
Epoch 400, Loss 0.025296
Epoch 500, Loss 0.022109
Epoch 600, Loss 0.019061
Epoch 700, Loss 0.016219
Epoch 800, Loss 0.013977
Epoch 900, Loss 0.012220
Epoch 1000, Loss 0.010949
Epoch 1100, Loss 0.009682
Epoch 1200, Loss 0.008349
Epoch 1300, Loss 0.007045
Epoch 1400, Loss 0.005937
Epoch 1500, Loss 0.005065
Epoch 1600, Loss 0.004278
0.9161706929902744 1.4799336669149674
ESZ 4000.0
0.0677155927178135
0.5942644593503829
DM Search Optimized Policy Value: 0.8446446580804916
Epoch 1700, Loss 0.003808
Epoch 1800, Loss 0.003428
1.034660510746602 1.591113978625761
ESZ 4000.0
0.05984066610389506
0.5749284394598637
DM Search Optimized Policy Value: 0.8023598632947195
Epoch 1900, Loss 0.003151
Epoch 2000, Loss 0.002891
1.0618637639858484 1.6313518835208194
ESZ 4000.0
0.053158066308822464
0.5711346479137489
DM Search Optimized Policy Value: 0.7620200003220875
Epoch 2100, Loss 0.002682
Epoch 2200, Loss 0.002498
1.0673763850754256 1.658631569295546
ESZ 4000.0
0.04946107581386539
0.5810070634729154
DM Search Optimized Policy Value: 0.7267039470802056
Epoch 2300, Loss 0.002345
Epoch 2400, Loss 0.002230
1.0384790305641791 1.6602103462605975
ESZ 4000.0
0.04656037186721075
0.5904190221219728
DM Search Optimized Policy Value: 0.6899732046259902
Epoch 2500, Loss 0.002094
Epoch 2600, Loss 0.001992
0.9967815234199092 1.6452298546032094
ESZ 4000.0
0.04423296450754551
0.5990750968559451
DM Search Optimized Policy Value: 0.6613163520601745
Epoch 2700, Loss 0.001915
Epoch 2800, Loss 0.001803
0.9736778773991536 1.6373949436305661
ESZ 4000.0
0.04274380481099599
0.6052776508953284
DM Search Optimized Policy Value: 0.6420975736398109
Epoch 2900, Loss 0.001764
Epoch 3000, Loss 0.001695
0.9620373872079676 1.6451486912133895
ESZ 4000.0
0.04058601156253571
0.6147201159991081
DM Search Optimized Policy Value: 0.6291320642890944
Epoch 3100, Loss 0.001636
Epoch 3200, Loss 0.001565
0.9659908145413393 1.659074821206405
ESZ 4000.0
0.04035908432931076
0.6226323477071793
DM Search Optimized Policy Value: 0.6221463069480063
Epoch 3300, Loss 0.001539
Epoch 3400, Loss 0.001470
0.9736418739176765 1.667331468211999
ESZ 4000.0
0.037959430021043905
0.616014152478355
DM Search Optimized Policy Value: 0.6229792345403955
Epoch 3500, Loss 0.001424
Epoch 3600, Loss 0.001388
0.9863884596909367 1.6766292006209145
ESZ 4000.0
0.03707340987373837
0.6126311502955459
DM Search Optimized Policy Value: 0.6258944676479271
Epoch 3700, Loss 0.001368
Epoch 3800, Loss 0.001350
0.9917715227063035 1.685760142267531
ESZ 4000.0
0.03660942346140619
0.619989759733365
DM Search Optimized Policy Value: 0.624737069966369
Epoch 3900, Loss 0.001284
Epoch 4000, Loss 0.001265
1.0182007138220315 1.7006831342117346
ESZ 4000.0
0.03526431664570124
0.03526431664570124
0.6014985910436417
DM Search Optimized Policy Value: 0.6319488965385294
[1610 2272  424  185 2251  801 2566 3513 1147 1460  236 2922 3607  117
 2231 2676 2500 1178 2934 2016]
[[2.08957551 0.27985102]
 [1.99911688 0.18938178]
 [2.06645897 0.24645896]
 [2.19256241 0.3659561 ]
 [2.24776382 0.40161951]
 [2.01614018 0.16772651]
 [2.00885762 0.14661491]
 [2.18253355 0.31296181]
 [2.03651666 0.15214998]
 [2.05730273 0.15992235]
 [2.3893085  0.48426471]
 [2.08353633 0.17257405]
 [2.23087702 0.31026391]
 [2.11575962 0.19466632]
 [2.17873455 0.2406053 ]
 [2.37162113 0.39721545]
 [2.20105097 0.21140532]
 [2.26997602 0.21359221]
 [2.43399073 0.31351794]
 [2.44873447 0.30694567]]
Over optimistic 0.4447177160795061
[0.40067817] [0.24298102] [0.21742876] [0.73113472]
4000.0
1.0
Epoch 100, Loss 0.038832
Epoch 200, Loss 0.035613
Epoch 300, Loss 0.030314
Epoch 400, Loss 0.024846
Epoch 500, Loss 0.021937
Epoch 600, Loss 0.020338
Epoch 700, Loss 0.018874
Epoch 800, Loss 0.017439
Epoch 900, Loss 0.016044
Epoch 1000, Loss 0.014844
Epoch 1100, Loss 0.013736
Epoch 1200, Loss 0.013016
Epoch 1300, Loss 0.011905
Epoch 1400, Loss 0.011106
Epoch 1500, Loss 0.009988
Epoch 1600, Loss 0.008989
0.18417657654793482 0.7008834711347904
ESZ 4000.0
0.0942540505191979
0.9876991022049875
DM Search Optimized Policy Value: 0.3369402945147065
Epoch 1700, Loss 0.007802
Epoch 1800, Loss 0.007148
0.6292349820049464 1.3358514658259977
ESZ 4000.0
0.08234296219969961
0.8439220547987507
DM Search Optimized Policy Value: 0.5091641032812925
Epoch 1900, Loss 0.006533
Epoch 2000, Loss 0.005509
1.0015337100309407 1.6502900983968365
ESZ 4000.0
0.08300431814251052
0.7547315277271873
DM Search Optimized Policy Value: 0.6461643472761742
Epoch 2100, Loss 0.006442
Epoch 2200, Loss 0.005374
1.247031533305826 1.8044888909287857
ESZ 4000.0
0.06556088685483455
0.6691304132545719
DM Search Optimized Policy Value: 0.6829151555276439
Epoch 2300, Loss 0.004381
Epoch 2400, Loss 0.005340
1.3373429185906487 1.8739198346181725
ESZ 4000.0
0.058382113303981326
0.6623952912177794
DM Search Optimized Policy Value: 0.6680224257400054
Epoch 2500, Loss 0.003835
Epoch 2600, Loss 0.003739
1.3854199597294168 1.9198023103279196
ESZ 4000.0
0.05674656057835526
0.6483396580438764
DM Search Optimized Policy Value: 0.6474376705217383
Epoch 2700, Loss 0.003718
Epoch 2800, Loss 0.003425
1.3592408855955687 1.9312241142444269
ESZ 4000.0
0.051946163930645474
0.6590818684999062
DM Search Optimized Policy Value: 0.624072443726906
Epoch 2900, Loss 0.004463
Epoch 3000, Loss 0.002687
1.382919686800446 1.9558943246339966
ESZ 4000.0
0.05504360213361506
0.6631914912588937
DM Search Optimized Policy Value: 0.6226406406754112
Epoch 3100, Loss 0.003365
Epoch 3200, Loss 0.002662
1.3729156583975488 1.9657797597228575
ESZ 4000.0
0.04879242272096919
0.6499033507109419
DM Search Optimized Policy Value: 0.6138488563151278
Epoch 3300, Loss 0.002752
Epoch 3400, Loss 0.002703
1.3652087472384378 1.9711741108158287
ESZ 4000.0
0.052800109044272736
0.660173772157306
DM Search Optimized Policy Value: 0.6094158414228831
Epoch 3500, Loss 0.003253
Epoch 3600, Loss 0.002210
1.3683441349816872 1.9748262500462372
ESZ 4000.0
0.054883197142959715
0.6584864248947799
DM Search Optimized Policy Value: 0.6106987943306278
Epoch 3700, Loss 0.003865
Epoch 3800, Loss 0.002576
1.3452439868738293 1.9610613430315214
ESZ 4000.0
0.04910360085767643
0.6287370489305546
DM Search Optimized Policy Value: 0.6091455648023275
Epoch 3900, Loss 0.002298
Epoch 4000, Loss 0.002070
1.3305743995502353 1.9570299509432387
ESZ 4000.0
0.047457070336448026
0.047457070336448026
0.6444587949417427
DM Search Optimized Policy Value: 0.6053439641572395
[3727 3178 2632 3311 2955  231 3581 1109 1850 1912 2728 3697 2244 2144
 1013  623 3653    4 1979 2573]
[[2.53305874 0.04580946]
 [2.55593659 0.05756909]
 [2.63093543 0.12954042]
 [2.57666923 0.06348564]
 [2.62561756 0.05190553]
 [2.71692601 0.13958173]
 [2.93581733 0.27506373]
 [2.78273042 0.12056205]
 [2.78612741 0.08965182]
 [2.89482424 0.17480999]
 [2.84299714 0.07380891]
 [2.85895384 0.07330291]
 [2.92223754 0.06552151]
 [2.92397252 0.06096032]
 [2.96320624 0.08183343]
 [6.51560525 3.60908431]
 [3.00344341 0.0595639 ]
 [3.12900901 0.04663691]
 [3.18651559 0.07544406]
 [3.20923281 0.06440763]]
Over optimistic 0.46413869899932947
[0.40067817] [0.24298102] [0.21742876] [0.73113472]
4000.0
1.0
Epoch 100, Loss 0.038935
Epoch 200, Loss 0.034613
Epoch 300, Loss 0.030380
Epoch 400, Loss 0.026279
Epoch 500, Loss 0.022820
Epoch 600, Loss 0.020173
Epoch 700, Loss 0.017878
Epoch 800, Loss 0.015730
Epoch 900, Loss 0.013869
Epoch 1000, Loss 0.012394
Epoch 1100, Loss 0.011095
Epoch 1200, Loss 0.009925
Epoch 1300, Loss 0.008745
Epoch 1400, Loss 0.007667
Epoch 1500, Loss 0.006605
Epoch 1600, Loss 0.005656
0.1380296789345363 0.5300766519604622
ESZ 4000.0
0.07524456839114006
0.7809968163912869
DM Search Optimized Policy Value: 0.6768559928440352
Epoch 1700, Loss 0.004840
Epoch 1800, Loss 0.004208
0.41771653820206917 0.9866410129740154
ESZ 4000.0
0.06866039210105261
0.6606558936854636
DM Search Optimized Policy Value: 0.7359447446517172
Epoch 1900, Loss 0.003704
Epoch 2000, Loss 0.003339
0.6981076440650866 1.291238971706328
ESZ 4000.0
0.05719573690894755
0.6212996634708954
DM Search Optimized Policy Value: 0.746370816001219
Epoch 2100, Loss 0.003007
Epoch 2200, Loss 0.002735
0.8540280581462824 1.4419047400879055
ESZ 4000.0
0.051902684383738164
0.5931373974743746
DM Search Optimized Policy Value: 0.7213450632963404
Epoch 2300, Loss 0.002501
Epoch 2400, Loss 0.002348
0.9145199205144461 1.5041200437446862
ESZ 4000.0
0.04905098220555516
0.5848545540630091
DM Search Optimized Policy Value: 0.6862229841753665
Epoch 2500, Loss 0.002153
Epoch 2600, Loss 0.002030
0.9268124627028838 1.5311232858875228
ESZ 4000.0
0.04536380827873517
0.5968186418557673
DM Search Optimized Policy Value: 0.6564730714316613
Epoch 2700, Loss 0.001922
Epoch 2800, Loss 0.001853
0.9189924662181757 1.5430132032574133
ESZ 4000.0
0.04326603915431357
0.6079479543995984
DM Search Optimized Policy Value: 0.6304106915397011
Epoch 2900, Loss 0.001774
Epoch 3000, Loss 0.001667
0.9270046126540589 1.564061131420167
ESZ 4000.0
0.04068573406160289
0.6185785146142141
DM Search Optimized Policy Value: 0.6113005727029031
Epoch 3100, Loss 0.001607
Epoch 3200, Loss 0.001564
0.9169252731278499 1.5753198409394504
ESZ 4000.0
0.03928997719167156
0.6284280470090453
DM Search Optimized Policy Value: 0.5938432886485924
Epoch 3300, Loss 0.001507
Epoch 3400, Loss 0.001469
0.904252085084784 1.5801652903116925
ESZ 4000.0
0.03793099623350155
0.6320461129188373
DM Search Optimized Policy Value: 0.5766585282833452
Epoch 3500, Loss 0.001427
Epoch 3600, Loss 0.001387
0.9052003554033472 1.5911978579050372
ESZ 4000.0
0.03734325569305707
0.6370619050933034
DM Search Optimized Policy Value: 0.565872475657602
Epoch 3700, Loss 0.001350
Epoch 3800, Loss 0.001322
0.8974097563909861 1.5935466895603703
ESZ 4000.0
0.03616396361770581
0.638071361638487
DM Search Optimized Policy Value: 0.5560976736621545
Epoch 3900, Loss 0.001297
Epoch 4000, Loss 0.001292
0.8832934613077019 1.5870127105457943
ESZ 4000.0
0.035666530724959546
0.035666530724959546
0.6537588292698506
DM Search Optimized Policy Value: 0.5508598230789289
[2680   28 1502 1225 2581  112    5 3345 3178 2632 1987 3311  231 3581
 1109 1850 1912 2728 1013 1979]
[[2.3903825  0.10134276]
 [2.45867152 0.16222779]
 [2.37041807 0.06228631]
 [2.44272428 0.07625238]
 [2.50670072 0.10390175]
 [2.59017518 0.18694178]
 [2.61367566 0.18513591]
 [2.5503656  0.08175824]
 [2.55593659 0.05724184]
 [2.63093543 0.12892427]
 [2.56933322 0.05932573]
 [2.57666923 0.06348564]
 [2.71692601 0.13958173]
 [2.93581733 0.27506373]
 [2.78273042 0.12056205]
 [2.78612741 0.08917985]
 [2.89482424 0.17402175]
 [2.84299714 0.07380891]
 [2.96320624 0.08183343]
 [3.18651559 0.07544406]]
Over optimistic 0.5601348315225275
[0.40067817] [0.24298102] [0.21742876] [0.73113472]
4000.0
1.0
Epoch 100, Loss 0.041619
Epoch 200, Loss 0.036292
Epoch 300, Loss 0.030497
Epoch 400, Loss 0.025768
Epoch 500, Loss 0.022421
Epoch 600, Loss 0.019869
Epoch 700, Loss 0.017627
Epoch 800, Loss 0.015473
Epoch 900, Loss 0.013354
Epoch 1000, Loss 0.011431
Epoch 1100, Loss 0.009821
Epoch 1200, Loss 0.008107
Epoch 1300, Loss 0.006690
Epoch 1400, Loss 0.005652
Epoch 1500, Loss 0.004875
Epoch 1600, Loss 0.004323
0.4808754691722517 1.1559790465938344
ESZ 4000.0
0.06527659800370354
0.7522065495282669
DM Search Optimized Policy Value: 0.5751485143861211
Epoch 1700, Loss 0.003916
Epoch 1800, Loss 0.003566
0.5946582893144323 1.281921276744034
ESZ 4000.0
0.059316226371302384
0.7091485763641642
DM Search Optimized Policy Value: 0.5950374259340893
Epoch 1900, Loss 0.003285
Epoch 2000, Loss 0.003059
0.6063217525735911 1.30034685254838
ESZ 4000.0
0.05490343835683781
0.6928777970648451
DM Search Optimized Policy Value: 0.5776044621076187
Epoch 2100, Loss 0.002872
Epoch 2200, Loss 0.002738
0.6208813673934163 1.3240770202868015
ESZ 4000.0
0.05146018212150396
0.6897100948886791
DM Search Optimized Policy Value: 0.5633388838024951
Epoch 2300, Loss 0.002551
Epoch 2400, Loss 0.002420
0.6028232502900257 1.3169521199432297
ESZ 4000.0
0.04888000878659974
0.6912501204152021
DM Search Optimized Policy Value: 0.5392422784333483
Epoch 2500, Loss 0.002312
Epoch 2600, Loss 0.002206
0.5852970860944767 1.297184127910757
ESZ 4000.0
0.04666234499995497
0.6947098172376075
DM Search Optimized Policy Value: 0.5244883285085625
Epoch 2700, Loss 0.002109
Epoch 2800, Loss 0.002115
0.5704156329470347 1.2814064893725352
ESZ 4000.0
0.045586297889967604
0.6885721827991579
DM Search Optimized Policy Value: 0.5128225388798417
Epoch 2900, Loss 0.001949
Epoch 3000, Loss 0.001901
0.5875692097678459 1.3066183577022297
ESZ 4000.0
0.04367366657467937
0.6846170935786083
DM Search Optimized Policy Value: 0.5140593959741819
Epoch 3100, Loss 0.001840
Epoch 3200, Loss 0.001775
0.6157687090338795 1.3379871688719713
ESZ 4000.0
0.042157925294526624
0.6847763805411712
DM Search Optimized Policy Value: 0.5203027044710146
Epoch 3300, Loss 0.001734
Epoch 3400, Loss 0.001672
0.6458439487805259 1.3707295733356757
ESZ 4000.0
0.040718027019745556
0.6728021095774944
DM Search Optimized Policy Value: 0.5272044547516791
Epoch 3500, Loss 0.001641
Epoch 3600, Loss 0.001589
0.6840528268038306 1.40748762314753
ESZ 4000.0
0.039980507367538956
0.6622896800207461
DM Search Optimized Policy Value: 0.5389879600550233
Epoch 3700, Loss 0.001555
Epoch 3800, Loss 0.001506
0.7575333080444703 1.4793976502927577
ESZ 4000.0
0.038817022221227945
0.6486237562493558
DM Search Optimized Policy Value: 0.559923716111671
Epoch 3900, Loss 0.001472
Epoch 4000, Loss 0.001454
0.7902872081085329 1.5075359403930304
ESZ 4000.0
0.03769228484638865
0.03769228484638865
0.6365531739549558
DM Search Optimized Policy Value: 0.5703473036208684
[1779 2942 3959 2951 3524 2228  341 2060 2722 2680   28  112    5 2632
  231 3581 1109 1850 1912 1979]
[[2.35870731 0.17462639]
 [2.32491796 0.1191733 ]
 [2.31502502 0.10203766]
 [2.32968931 0.10481103]
 [2.32001963 0.07502511]
 [2.36081845 0.10572185]
 [2.41070873 0.14218382]
 [2.36770914 0.08697552]
 [2.48766066 0.20371305]
 [2.3903825  0.10134276]
 [2.45867152 0.16222779]
 [2.59017518 0.18694178]
 [2.61367566 0.18513591]
 [2.63093543 0.12892427]
 [2.71692601 0.13958173]
 [2.93581733 0.27506373]
 [2.78273042 0.12056205]
 [2.78612741 0.08917985]
 [2.89482424 0.17402175]
 [3.18651559 0.07544406]]
Over optimistic 0.49425946445517344
[0.40067817] [0.24298102] [0.21742876] [0.73113472]
4000.0
1.0
Epoch 100, Loss 0.036770
Epoch 200, Loss 0.030641
Epoch 300, Loss 0.024205
Epoch 400, Loss 0.021181
Epoch 500, Loss 0.018959
Epoch 600, Loss 0.016932
Epoch 700, Loss 0.015112
Epoch 800, Loss 0.013304
Epoch 900, Loss 0.011671
Epoch 1000, Loss 0.010061
Epoch 1100, Loss 0.008538
Epoch 1200, Loss 0.007151
Epoch 1300, Loss 0.005971
Epoch 1400, Loss 0.004987
Epoch 1500, Loss 0.004279
Epoch 1600, Loss 0.003806
1.0548075902153098 1.6560644233159334
ESZ 4000.0
0.06085403579108683
0.6347280766090434
DM Search Optimized Policy Value: 0.7925967436601022
Epoch 1700, Loss 0.003339
Epoch 1800, Loss 0.003079
1.1011279270280667 1.7204099195742377
ESZ 4000.0
0.0551755006396483
0.6157927215920576
DM Search Optimized Policy Value: 0.7491146063453137
Epoch 1900, Loss 0.002868
Epoch 2000, Loss 0.002658
1.0550561874555224 1.7057926693248833
ESZ 4000.0
0.05257511281035394
0.6103915245644239
DM Search Optimized Policy Value: 0.7033463897258662
Epoch 2100, Loss 0.002511
Epoch 2200, Loss 0.002359
1.0046119838471566 1.6905401948322472
ESZ 4000.0
0.0492794164159647
0.6176589745617864
DM Search Optimized Policy Value: 0.6699072803237325
Epoch 2300, Loss 0.002253
Epoch 2400, Loss 0.002134
0.9817331350967579 1.693378527257219
ESZ 4000.0
0.04571051903760792
0.6279885807391197
DM Search Optimized Policy Value: 0.6425721098343975
Epoch 2500, Loss 0.002024
Epoch 2600, Loss 0.001954
0.943566147695597 1.6751038888072192
ESZ 4000.0
0.04415037528460136
0.6373194309132008
DM Search Optimized Policy Value: 0.6205764195029024
Epoch 2700, Loss 0.001894
Epoch 2800, Loss 0.001816
0.898148747210181 1.6447270738620976
ESZ 4000.0
0.04451699466230549
0.6316162202959494
DM Search Optimized Policy Value: 0.602354628293198
Epoch 2900, Loss 0.001764
Epoch 3000, Loss 0.001696
0.8975791112375848 1.6503284334372583
ESZ 4000.0
0.040891794395276876
0.6403840261170172
DM Search Optimized Policy Value: 0.5976362777784273
Epoch 3100, Loss 0.001670
Epoch 3200, Loss 0.001636
0.8894782860779169 1.6468439696072934
ESZ 4000.0
0.040205520249393285
0.6415605319572637
DM Search Optimized Policy Value: 0.5923606076205474
Epoch 3300, Loss 0.001578
Epoch 3400, Loss 0.001536
0.8813568017795594 1.637133717231317
ESZ 4000.0
0.04131541928832111
0.627267208627262
DM Search Optimized Policy Value: 0.5921904988141845
Epoch 3500, Loss 0.001513
Epoch 3600, Loss 0.001470
0.9181501275312207 1.6705005887823854
ESZ 4000.0
0.03786295399899776
0.6299710942501874
DM Search Optimized Policy Value: 0.5977433731005583
Epoch 3700, Loss 0.001440
Epoch 3800, Loss 0.001405
0.9239823513818046 1.6754147341460164
ESZ 4000.0
0.03703910544094762
0.6253463141514963
DM Search Optimized Policy Value: 0.6005221459570877
Epoch 3900, Loss 0.001382
Epoch 4000, Loss 0.001361
0.9446034619265203 1.690287343524839
ESZ 4000.0
0.03850684303048127
0.03850684303048127
0.6184978979660339
DM Search Optimized Policy Value: 0.6046096073357471
[2522 1710 3629 1242 3772  406 2272 1610  424  185 2251  801 3513  236
  117 3607 2676 2934 2016  623]
[[1.89184668 0.17362777]
 [1.95306171 0.23090718]
 [2.15915444 0.43146934]
 [1.99289859 0.22508096]
 [1.96945959 0.20100526]
 [1.99985432 0.20799227]
 [1.99911688 0.18938178]
 [2.08957551 0.27886692]
 [2.06645897 0.24645896]
 [2.19256241 0.3659561 ]
 [2.24776382 0.4028839 ]
 [2.01614018 0.16634714]
 [2.18253355 0.31296181]
 [2.3893085  0.48282374]
 [2.11575962 0.19466632]
 [2.23087702 0.30918788]
 [2.37162113 0.39721545]
 [2.43399073 0.31239982]
 [2.44873447 0.30694567]
 [6.51560525 4.23184375]]
Over optimistic 0.5008285534639471
Train: 0.03891740911679574
Test: 0.6309534574352449
[0.6319488965385294, 0.6053439641572395, 0.5508598230789289, 0.5703473036208684, 0.6046096073357471]
Value: 0.5926219189462627
